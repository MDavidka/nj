import { renderNavbar } from './components/navbar';
 import { renderFooter } from './components/footer';
 import { renderHero } from './components/hero';
 import { renderArticleList } from './components/articleList';
 import { fetchArticles } from './api/mockArticles';
 import { formatDate } from './utils/dateFormatter';
 import { Article } from './types/article';

 interface AppState {
  articles: Article[];
  loading: boolean;
  error: string | null;
 }

 class App {
  private state: AppState = {
   articles: [],
   loading: true,
   error: null,
  };

  constructor() {
   this.init();
  }

  async init() {
   try {
    this.state.articles = await fetchArticles();
    this.state.loading = false;
    this.render();
   } catch (error: any) {
    this.state.loading = false;
    this.state.error = 'Failed to load articles.';
    console.error(error);
    this.render();
   }
  }

  setState(newState: Partial<AppState>) {
   this.state = { ...this.state, ...newState };
   this.render();
  }

  render() {
   const root = document.getElementById('root');
   if (!root) {
    console.error('Root element not found.');
    return;
   }

   // Clear existing content
   root.innerHTML = '';

   // Navbar
   const navbar = renderNavbar();
   root.appendChild(navbar);

   // Hero Section
   const heroData = {
    title: 'Welcome to Our Modern Site',
    subtitle: 'Explore the latest articles and trends.',
    imageUrl: 'https://images.unsplash.com/photo-1682685797524-cc9998f4118d?q=80&w=2070&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDF8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D', // Replace with your image URL
    callToActionText: 'Learn More',
    callToActionLink: '#articles',
   };
   const hero = renderHero(heroData);
   root.appendChild(hero);

   // Article List
   if (this.state.loading) {
    const loadingMessage = document.createElement('p');
    loadingMessage.textContent = 'Loading articles...';
    loadingMessage.className = 'text-center py-4';
    root.appendChild(loadingMessage);
   } else if (this.state.error) {
    const errorMessage = document.createElement('p');
    errorMessage.textContent = this.state.error;
    errorMessage.className = 'text-center text-red-500 py-4';
    root.appendChild(errorMessage);
   } else {
    const articleList = renderArticleList(this.state.articles);
    root.appendChild(articleList);
   }

   // Footer
   const footer = renderFooter();
   root.appendChild(footer);
  }
 }

 // Initialize the app when the DOM is ready
 document.addEventListener('DOMContentLoaded', () => {
  new App();
 });